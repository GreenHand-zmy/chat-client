<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
	</head>
	<body>
		<div>发送消息</div>
		<input type="text" id="msgContent"/>
		<input type="button" value="点我发送" onclick="Chat.chat()"/>
		
		<div>接受消息</div>
		<div id="receivemsg" style="background-color: gray;"></div>
		
		<script type="text/javascript">
			window.Chat = {
				socket:null,
				init:function(){
					if(window.WebSocket){
						Chat.socket = new WebSocket("ws://localhost:8090/ws");
						
						Chat.socket.onopen = function(){
							console.log("连接成功....");
						};
						
						Chat.socket.onclose = function(){
							console.log("连接关闭....");
						};
						
						Chat.socket.onerror = function(){
							console.log("发生成功....");
						}
						
						Chat.socket.onmessage = function(result){
							console.log("接受到消息...." + result.data);
							var receivemsg = document.getElementById("receivemsg");
							var html = receivemsg.innerHTML;
							receivemsg.innerHTML = html+ "<br/>" + result.data;
							
						}
					}else{
						alert("浏览器不支持websocket协议...");
					}
				},
				chat:function(){
					var message = document.getElementById("msgContent");
					Chat.socket.send(message.value);
				}
			};
			Chat.init();
		</script>
	</body>
</html>
